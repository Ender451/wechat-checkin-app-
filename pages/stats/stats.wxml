
<!--stats.wxml-->
<view class="container">
  <view class="stats-cards">
    <view class="card">
      <view class="card-title">æ€»æ‰“å¡å¤©æ•°</view>
      <view class="card-value">{{stats.totalDays}}</view>
    </view>
    
    <view class="card">
      <view class="card-title">å¹³å‡å·¥ä½œæ—¶é•¿</view>
      <view class="card-value">{{stats.avgWorkTime}}</view>
    </view>
    
    <view class="card">
      <view class="card-title">åŠ ç­å¤©æ•°</view>
      <view class="card-value">{{stats.totalOvertimeDays}}</view>
    </view>
    
    <view class="card">
      <view class="card-title">æ€»åŠ ç­æ—¶é•¿</view>
      <view class="card-value">{{stats.totalOvertimeTime}}</view>
    </view>
    
    <view class="card">
      <view class="card-title">æœ€æ—©ä¸Šç­æ—¶é—´</view>
      <view class="card-value">{{stats.earliestClockIn}}</view>
    </view>
    
    <view class="card">
      <view class="card-title">æœ€æ™šä¸‹ç­æ—¶é—´</view>
      <view class="card-value">{{stats.latestClockOut}}</view>
    </view>
  </view>
  
  <view class="filter-section">
    <view class="filter-label">æ—¶é—´ç­›é€‰</view>
    <view class="filter-row">
      <view class="filter-select {{isRecent30Days || isAllTime ? '' : 'active'}}">
        <picker mode="date" fields="month" value="{{selectedMonth}}" bindchange="onMonthChange">
          <view class="select-btn">{{selectedMonth || 'é€‰æ‹©æœˆä»½'}}</view>
        </picker>
      </view>
      <button class="filter-btn {{isAllTime ? 'active' : ''}}" bindtap="resetToAllTime">
        <text>å…¨éƒ¨æ—¶é—´</text>
      </button>
      <button class="filter-btn {{isRecent30Days ? 'active' : ''}}" bindtap="resetToRecentDays">
        <text>æœ€è¿‘30å¤©</text>
      </button>
    </view>
  </view>
  
  <view class="chart-section">
    <view class="chart-title">{{chartTitle}}</view>
    <view wx:if="{{chartData}}">
      <canvas canvas-id="timeChart" class="chart-canvas"></canvas>
      <view class="chart-legend">
        <view class="legend-item">
          <view class="legend-color" style="background-color: #1aad19;"></view>
          <text>ä¸Šç­æ—¶é—´</text>
        </view>
        <view class="legend-item">
          <view class="legend-color" style="background-color: #e64340;"></view>
          <text>ä¸‹ç­æ—¶é—´</text>
        </view>
        <view class="legend-item">
          <view class="legend-color" style="background-color: rgba(0, 122, 255, 0.4);"></view>
          <text>å·¥ä½œæ—¶é•¿</text>
        </view>
        <view class="legend-item">
          <view class="legend-color" style="background-color: rgba(255, 107, 53, 0.6);"></view>
          <text>åŠ ç­æ—¶é•¿</text>
        </view>
      </view>
      <view class="chart-note" wx:if="{{isAllTime && records.length > 90}}">
        <text>ğŸ“Š æ•°æ®ç‚¹è¿‡å¤šï¼Œå›¾è¡¨å·²é‡‡æ ·æ˜¾ç¤ºã€‚ç»Ÿè®¡æ•°æ®åŸºäºå…¨éƒ¨æ•°æ®ã€‚</text>
      </view>
    </view>
    <view wx:else class="no-chart-tip">
      <text>ğŸ“… è¯·é€‰æ‹©æ—¶é—´èŒƒå›´ä»¥æŸ¥çœ‹è¶‹åŠ¿å›¾è¡¨</text>
    </view>
  </view>
</view>